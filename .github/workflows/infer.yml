name: Infer Static Analysis
permissions:
  contents: read
on:
  - push
  - pull_request
jobs:
  infer:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v6
      - uses: actions/setup-python@v6
      - name: Install build dependencies
        run: sudo apt-get update && sudo apt-get install -y meson
      - name: Setup Infer
        uses: srz-zumix/setup-infer@v1
      - name: Configure Meson
        run: meson setup build -Dfuzzer=true
      - name: Run Infer
        run: infer run --fail-on-issue --disable-issue-type PULSE_UNINITIALIZED_VALUE --compilation-database build/compile_commands.json
